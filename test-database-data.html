<!DOCTYPE html>
<html>
<head>
    <title>Test Database Data</title>
</head>
<body>
    <h1>Check Database Data</h1>
    <button onclick="login()">1. Login First</button>
    <button onclick="checkCompanies()">2. Check Companies</button>
    <button onclick="checkDepartments()">3. Check Departments</button>
    <button onclick="checkBusinessHours()">4. Check Business Hours</button>
    <button onclick="checkHolidayLists()">5. Check Holiday Lists</button>
    <pre id="output"></pre>

    <script>
        const BACKEND_URL = 'https://backend-production-97e1.up.railway.app';
        const output = document.getElementById('output');
        let token = '';

        async function login() {
            output.textContent = 'Logging in...\n';
            try {
                const response = await fetch(`${BACKEND_URL}/api/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'admin@bomizzel.com',
                        password: 'password123'
                    })
                });
                const data = await response.json();
                if (data.token) {
                    token = data.token;
                    output.textContent += `✅ Logged in successfully\n`;
                    output.textContent += `Token: ${token.substring(0, 20)}...\n`;
                } else {
                    output.textContent += `❌ Login failed: ${JSON.stringify(data)}\n`;
                }
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
            }
        }

        async function checkCompanies() {
            if (!token) {
                output.textContent = '❌ Please login first\n';
                return;
            }
            output.textContent = 'Checking companies...\n';
            try {
                const response = await fetch(`${BACKEND_URL}/api/agents/accounts`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                output.textContent += `Status: ${response.status}\n`;
                output.textContent += `Companies found: ${data.data?.length || 0}\n`;
                output.textContent += JSON.stringify(data, null, 2);
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
            }
        }

        async function checkDepartments() {
            if (!token) {
                output.textContent = '❌ Please login first\n';
                return;
            }
            output.textContent = 'Checking departments...\n';
            try {
                const response = await fetch(`${BACKEND_URL}/api/departments`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                output.textContent += `Status: ${response.status}\n`;
                if (Array.isArray(data)) {
                    output.textContent += `Departments found: ${data.length}\n`;
                } else {
                    output.textContent += `Response: ${JSON.stringify(data)}\n`;
                }
                output.textContent += JSON.stringify(data, null, 2);
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
            }
        }

        async function checkBusinessHours() {
            if (!token) {
                output.textContent = '❌ Please login first\n';
                return;
            }
            output.textContent = 'Checking business hours...\n';
            try {
                const response = await fetch(`${BACKEND_URL}/api/business-hours`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                output.textContent += `Status: ${response.status}\n`;
                output.textContent += JSON.stringify(data, null, 2);
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
            }
        }

        async function checkHolidayLists() {
            if (!token) {
                output.textContent = '❌ Please login first\n';
                return;
            }
            output.textContent = 'Checking holiday lists...\n';
            try {
                const response = await fetch(`${BACKEND_URL}/api/holiday-lists`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                output.textContent += `Status: ${response.status}\n`;
                output.textContent += JSON.stringify(data, null, 2);
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
            }
        }
    </script>
</body>
</html>
